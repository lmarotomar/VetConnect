<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Iniciar Sesi√≥n - VetConnect</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        .login-container {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--bg-primary);
            padding: 2rem;
        }

        .login-box {
            width: 100%;
            max-width: 450px;
            background: var(--bg-glass);
            backdrop-filter: blur(10px);
            border: 2px solid var(--border-glass);
            border-radius: var(--radius-xl);
            padding: 3rem;
            box-shadow: var(--shadow-xl);
        }

        .login-logo {
            text-align: center;
            margin-bottom: 2rem;
        }

        .login-logo img {
            width: 80px;
            height: 80px;
            object-fit: contain;
            margin-bottom: 1rem;
        }

        .login-logo h1 {
            font-size: 2rem;
            font-family: var(--font-heading);
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 0.5rem;
        }

        .login-role-tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 2rem;
            background: var(--bg-secondary);
            padding: 0.25rem;
            border-radius: var(--radius-md);
        }

        .role-tab {
            flex: 1;
            padding: 0.75rem;
            border: none;
            background: transparent;
            color: var(--text-secondary);
            border-radius: var(--radius-sm);
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
            font-size: 0.875rem;
        }

        .role-tab.active {
            background: var(--primary-gradient);
            color: white;
        }

        .demo-credentials {
            background: var(--bg-secondary);
            border-radius: var(--radius-md);
            padding: 1rem;
            margin-bottom: 1.5rem;
            font-size: 0.875rem;
        }

        .demo-cred-item {
            margin: 0.5rem 0;
            padding: 0.5rem;
            background: var(--bg-glass);
            border-radius: var(--radius-sm);
        }
    </style>
</head>

<body>
    <div class="login-container">
        <div class="login-box">
            <!-- Logo -->
            <div class="login-logo">
                <img src="assets/logo.jpg" alt="VetConnect">
                <h1>VetConnect</h1>
                <p style="color: var(--text-secondary); font-size: 0.875rem;">
                    Sistema Integral de Automatizaci√≥n Veterinaria
                </p>
            </div>

            <!-- Role Tabs -->
            <div class="login-role-tabs">
                <button class="role-tab active" data-role="admin" onclick="switchRole('admin')">
                    üîß Admin
                </button>
                <button class="role-tab" data-role="clinic" onclick="switchRole('clinic')">
                    üè• Cl√≠nica
                </button>
                <button class="role-tab" data-role="vet" onclick="switchRole('vet')">
                    üë®‚Äç‚öïÔ∏è Veterinario
                </button>
            </div>

            <!-- Demo Credentials Box -->
            <div class="demo-credentials" id="demoCredentials">
                <div style="font-weight: 600; margin-bottom: 0.75rem; color: var(--brand-gold);">
                    üîë Credenciales de Demo:
                </div>
                <div class="demo-cred-item" id="adminDemo">
                    <strong>Super Admin (Platform Owner):</strong><br>
                    Email: <code>admin@vetconnect.com</code><br>
                    Password: <code>demo123</code>
                </div>
                <div class="demo-cred-item" id="clinicDemo" style="display:none;">
                    <strong>Administrador de Cl√≠nica:</strong><br>
                    Email: <code>admin@clinicaveterinaria.com</code><br>
                    Password: <code>demo123</code>
                </div>
                <div class="demo-cred-item" id="vetDemo" style="display:none;">
                    <strong>Veterinario:</strong><br>
                    Email: <code>vet@clinicaveterinaria.com</code><br>
                    Password: <code>demo123</code>
                </div>
            </div>

            <!-- Login Form -->
            <form id="loginForm" onsubmit="handleLogin(event)">
                <div class="form-group">
                    <label class="form-label">Email</label>
                    <input type="email" class="form-input" id="emailInput" placeholder="tu@email.com" required>
                </div>

                <div class="form-group">
                    <label class="form-label">Contrase√±a</label>
                    <input type="password" class="form-input" id="passwordInput" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
                </div>

                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                        <input type="checkbox" id="rememberMe">
                        <span style="font-size: 0.875rem;">Recordarme</span>
                    </label>
                    <a href="#" style="font-size: 0.875rem; color: var(--brand-gold); text-decoration: none;">
                        ¬øOlvidaste tu contrase√±a?
                    </a>
                </div>

                <button type="submit" class="btn btn-primary" style="width: 100%; padding: 1rem; font-size: 1.125rem;"
                    id="loginButton">
                    Iniciar Sesi√≥n
                </button>
            </form>

            <!-- Divider -->
            <div style="display: flex; align-items: center; gap: 1rem; margin: 2rem 0;">
                <div style="flex: 1; height: 1px; background: var(--border-glass);"></div>
                <span style="color: var(--text-muted); font-size: 0.875rem;">o</span>
                <div style="flex: 1; height: 1px; background: var(--border-glass);"></div>
            </div>

            <!-- Quick Actions -->
            <div style="text-align: center;">
                <p style="color: var(--text-secondary); font-size: 0.875rem; margin-bottom: 1rem;">
                    ¬øNo tienes una cuenta?
                </p>
                <a href="pricing.html" class="btn btn-secondary" style="width: 100%; padding: 0.875rem;">
                    üéÅ Probar Gratis 14 D√≠as
                </a>
            </div>

            <!-- Footer Links -->
            <div
                style="text-align: center; margin-top: 2rem; padding-top: 2rem; border-top: 1px solid var(--border-glass);">
                <div style="display: flex; justify-content: center; gap: 1.5rem; font-size: 0.875rem;">
                    <a href="legal/terms-of-service.md" target="_blank"
                        style="color: var(--text-muted); text-decoration: none;">T√©rminos</a>
                    <a href="legal/privacy-policy.md" target="_blank"
                        style="color: var(--text-muted); text-decoration: none;">Privacidad</a>
                    <a href="legal.html" style="color: var(--text-muted); text-decoration: none;">Legal</a>
                </div>
            </div>

            <!-- Loading Overlay -->
            <div id="loadingOverlay"
                style="display: none; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.7); border-radius: var(--radius-xl); align-items: center; justify-content: center; flex-direction: column; gap: 1rem;">
                <div class="spinner"></div>
                <div style="color: white;">Iniciando sesi√≥n...</div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="backend/utils/auth-manager.js"></script>
    <script>
        // Initialize email field on load
        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById('emailInput').value = 'admin@vetconnect.com';
        });

        function switchRole(role) {
            // Update active tab
            document.querySelectorAll('.role-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelector(`[data-role="${role}"]`).classList.add('active');

            // Show appropriate demo credentials
            document.getElementById('adminDemo').style.display = role === 'admin' ? 'block' : 'none';
            document.getElementById('clinicDemo').style.display = role === 'clinic' ? 'block' : 'none';
            document.getElementById('vetDemo').style.display = role === 'vet' ? 'block' : 'none';

            // Auto-fill email based on role
            const emailMap = {
                'admin': 'admin@vetconnect.com',
                'clinic': 'admin@clinicaveterinaria.com',
                'vet': 'vet@clinicaveterinaria.com'
            };
            document.getElementById('emailInput').value = emailMap[role];
        }

        async function handleLogin(event) {
            event.preventDefault();

            const email = document.getElementById('emailInput').value;
            const password = document.getElementById('passwordInput').value;
            const loginButton = document.getElementById('loginButton');
            const loadingOverlay = document.getElementById('loadingOverlay');

            // Show loading
            loginButton.disabled = true;
            loadingOverlay.style.display = 'flex';

            try {
                const result = await AuthManager.login(email, password);

                if (result.success) {
                    // Success handled by AuthManager (redirects automatically)
                } else {
                    // Show error
                    loadingOverlay.style.display = 'none';
                    loginButton.disabled = false;
                    alert('Error: ' + result.error);
                }
            } catch (error) {
                loadingOverlay.style.display = 'none';
                loginButton.disabled = false;
                alert('Error al iniciar sesi√≥n: ' + error.message);
            }
        }

        // Optional: Auto-fill password for demo
        document.getElementById('passwordInput').value = 'demo123';
    </script>
</body>

</html>